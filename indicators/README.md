# インジケーター定義ドキュメント（概念思想）

本ディレクトリには TradeAssist で使用するインジケーターの**概念定義**が含まれています。

> **実装仕様**については [docs/ARCHITECTURE.md](../docs/ARCHITECTURE.md) の「NoteEvaluator アーキテクチャ」を参照してください。

## 本ドキュメントの目的

- 数値と語彙の三層モデル（Layer1/2/3）の思想を統一
- インジケーターごとの判断基準・言語化ルールを定義
- 将来拡張時の設計指針を提供

## サポートインジケーター

| ID | 名称 | カテゴリ | 定義ファイル |
|----|------|----------|-------------|
| `rsi` | Relative Strength Index | momentum | [RSI.md](RSI.md) |
| `macd` | MACD | momentum | [MACD.md](MACD.md) |
| `bb` | Bollinger Bands | volatility | [BB.md](BB.md) |
| `sma` | Simple Moving Average | trend | [SMA.md](SMA.md) |
| `ema` | Exponential Moving Average | trend | [EMA.md](EMA.md) |

---

## 定義ドキュメント雛形

本雛形は TradeAssist に追加されるすべてのインジケーター定義で共通の骨組みを示す。思想・粒度・用語を統一し、数値と語彙の二層構造（三層モデル）を明示することを目的とする。

## メタ情報（管理用）
- indicator_id
- カテゴリ（trend / momentum / volatility 等）
- 定義バージョン
- 導入日

## 1. インジケーター概要
- 何を計測し、どの状況判断に使うかを 2〜3 行で記述する
- 数式や計算窓の前提（期間・データソース）を簡潔に示す

## 2. 想定トレーダーペルソナ
- 本インジケーターで意思決定する典型的な人物像（経験年数・リスク許容度・モニター頻度）
- 判断の粒度（例: 「分足で瞬時に判断」「日足でゆっくり判断」）

## 3. 対応トレードスタイル（スキャル / デイ）
- スキャル向けの利用方針（使用時間足、反応速度、許容ノイズ）
- デイ向けの利用方針（使用時間足、主要セッション、持ち越し可否）

## 4. 生データとして記録する項目（Layer1）
- 計算に必要な生データの列挙（例: 始値/高値/安値/終値、出来高、時間足、期間 N）
- サンプリング間隔・欠損補填方針・タイムゾーンの扱い
- 取得元（マーケットデータ API 名など）と精度要件

## 5. 判断コンテキスト（Layer2）
- Layer1 から導出する定量特徴量（例: 現在値、傾き、直近クロスの有無、距離）
- 境界値や方向性の取り扱い（上抜け/下抜け/接触判定の条件）
- 時系列での持続時間・直近 N 本の推移など、判断に必要な周辺情報
- 生の数値だけでなく、ユーザー基準に対する相対的位置（正規化値）を必ず保持する
- 絶対値ではなく「基準からどれだけ離れていたか」を将来比較可能にする

## 6. 言語化レイヤー（Layer3）
- Layer2 の定量結果を人が読む文章にマッピングするルール
- 「買われすぎ」「売られすぎ」「反転気配」などの語彙を定義し、数値条件と 1:1 に対応させる
- 曖昧表現を避け、閾値と方向を必ず明示する

## 7. ユーザー基準値の扱い
- 既定値とユーザーが変更可能なパラメータ（閾値、期間、許容ノイズ幅）
- 基準値を変更した場合にどのレイヤーへ反映するか（Layer1/2/3 それぞれ）
- 保存形式とバリデーション方針（例: 0〜100 の実数、整数のみなど）

## 8. マッチングに使用する特徴量
- ルールベース一致判定で参照する特徴量のリストと算出方法
- マッチング条件（例: 「RSI が基準上限を 2pt 超過し、かつ下降に転じた」）
- 得点化や理由付けのキーとなる項目を明示
- 複数インジケーターが矛盾する場合、役割（トレンド系 / 過熱系 / 位置系）を優先順位として扱う
- 単一インジケーターでの確定判断は行わず、矛盾時は注意喚起を生成する

## 9. AI が利用してよい情報 / 禁止情報
- AI が参照可能なデータ（Layer2/Layer3 のみ、個人設定の範囲など）
- 禁止情報（個別ユーザーの生データ、注文履歴、特定銘柄名など）
- プライバシーとリーク防止のためのマスキング・匿名化方針

## 10. 将来拡張時の注意点
- 期間変更や平滑化手法追加時に崩さないべき前提
- 他インジケーターとの組み合わせ（例: RSI×MA）の際の衝突回避ルール
- バージョニングと互換性維持の方針（既存ノート・マッチ判定への影響確認）

## 11. 本インジケーターが不適切な状況
- 強いトレンドが継続している局面では逆張り判断が機能しにくい
- 経済指標直前・直後など、非連続な価格変動時
- 出来高が極端に低い時間帯
- ユーザー設定が極端に偏っている場合（例: 閾値が非現実的な値）

## 新規インジケーター追加時

### 概念定義（本ディレクトリ）
1. 本雛形に従って `.md` ファイルを作成
2. Layer1/2/3 の三層モデルに沿って定義を記述
3. ユーザー基準値・言語化ルールを明確化

### 実装（別途）
実装手順については [docs/ARCHITECTURE.md](../docs/ARCHITECTURE.md) を参照。