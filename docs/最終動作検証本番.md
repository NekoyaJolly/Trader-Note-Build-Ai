# 最終動作検証 AI Agent 用プロンプト（完全版）

## 目的
本プロンプトは、**MCP サーバー**を利用して対象アプリケーションの**実際の UI を操作し、全ページ・全機能が仕様どおりに動作するかを最終検証**するための AI Agent 向け実行指示である。

- UI 操作は **実ブラウザ環境**（MCP 経由）で行うこと
- 全ページ・全ユーザー操作・全 API 連携を対象とすること
- エラー検出時は **修正を最優先**し、修正後に **該当範囲から検証を再開**すること
- 最終的に **検証サマリー（合否・残課題・再発防止観点）**を出力すること

---

## 前提条件（必須）

### 実行環境
- MCP Server が起動・接続可能であること
- 対象アプリは **本番相当環境**（Staging / Production）で稼働していること
- 使用ブラウザ：Chromium 系（MCP 標準）
- 認証情報（テストユーザー）が事前に付与されていること

### 禁止事項
- モック・スタブ・仮 UI を使った検証
- コード未反映状態での推測による合格判定
- エラーを検知したまま次工程へ進むこと

---

## 検証スコープ

### 1. 画面単位検証（必須）
以下を **全ページ** に対して実施すること：

- 初期表示（ロード、Skeleton、Loading 表示）
- 表示データの妥当性（API 応答との一致）
- UI 操作（クリック、入力、選択、スクロール）
- エラーハンドリング（バリデーション、API エラー）
- 状態遷移（画面遷移、モーダル、トースト等）

### 2. 機能単位検証（必須）

- CRUD 操作（作成 / 取得 / 更新 / 削除）
- 非同期処理（ローディング・二重送信防止）
- 権限・認可（未ログイン / 権限不足）
- 永続化確認（UI → API → DB → 再取得）

### 3. API 接続保証

- UI 操作により **正しい API が呼ばれているか**
- Request / Response の型・内容が仕様通りか
- 失敗時の UI 表示が適切か

---

## 検証手順（厳守）

### Step 1: アプリ起動確認
- MCP 経由で URL にアクセス
- 初期エラー（Console / Network）を確認

### Step 2: 認証フロー検証
- ログイン成功
- ログアウト
- セッション維持・期限切れ

### Step 3: 全ページ順次検証
- ナビゲーション経由で全ページを巡回
- 各ページで以下を必ず実施：
  - 主要操作をすべて 1 回以上実行
  - 異常系（未入力、境界値）を最低 1 件実行

### Step 4: エラー検知時の対応（最重要）

エラーを検知した場合、**即座に以下を実行すること**：

1. エラー内容を正確に特定
   - UI 表示
   - Console Error
   - Network Error
2. 原因切り分け
   - UI 実装
   - API
   - DB / 設定
3. 修正方針を決定し **直接修正を実行**
4. 修正後、
   - 当該機能
   - 影響範囲の関連機能
   を再検証

※ エラー未修正のまま次ページに進むことは禁止

---

## 記録ルール

### 検証ログ（必須）
以下の形式で内部的に検証ログを保持すること：

- ページ名
- 操作内容
- 期待結果
- 実結果
- 判定（OK / NG）
- 修正有無

---

## 最終サマリー出力（必須）

検証完了後、以下の形式で **最終サマリーを日本語で出力**すること。

### 1. 総合判定
- ✅ 合格 / ❌ 不合格

### 2. 検証範囲
- 検証ページ数
- 検証機能数

### 3. 修正対応一覧
| No | 機能 | 事象 | 原因 | 修正内容 | 再発防止 |

### 4. 未解決事項（存在する場合）
- 内容
- 理由
- 想定リスク

### 5. リリース可否判断
- 本番リリース可 / 不可
- 条件付きの場合は条件を明記

---

## AI Agent 補足指針（ベストプラクティス）

- 常に **ユーザー視点**で UI を評価すること
- 仕様が不明確な場合は「仕様不明」と明記し推測で合格にしない
- 1 つの OK 判定は必ず **実操作と結果確認**に基づくこと
- 最終目的は「動いているように見える」ではなく
  **「壊れないことが保証された状態」**である

---

## 成果物
- 本プロンプトに基づく **最終検証サマリー（Markdown）**
- 修正が発生した場合は **修正内容の要約**

以上を厳守し、最終検証を実行せよ。

