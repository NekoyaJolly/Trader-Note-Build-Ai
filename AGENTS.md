## 目的

このファイルは **Trader-Assist-MVP** プロジェクトにおいて、AI エージェントが
「何を・どこまで・どのような品質基準で」実装すべきかを正確に理解し、
**人間のレビュー負荷を最小化しつつ安全に開発を進める** ための公式指示書です。

本ファイルは README.md よりも **優先度が高いエージェント向け仕様書** です。
AI エージェントは、作業開始前に必ず全文を読み、遵守してください。

---

## 最重要ルール（必ず守ること）

### 1. 出力・記述言語ルール（★最優先）

**このリポジトリ内で生成・編集するすべての成果物について、以下を必須とします。**

* コメント、説明文、README、Doc、AGENTS.md 参照箇所は **日本語で記述すること**
* ソースコード内コメントも **原則すべて日本語**
* 例外として以下のみ英語可

  * プログラミング言語の予約語
  * ライブラリ・フレームワーク固有の英語 API 名
  * 公式仕様で英語が必須な設定キー

❌ 禁止事項

* 英語のみのコメント
* 日本語コメント無しでのロジック実装
* README や docs に英語説明のみを追加する行為
* any型、unknown型の使用は原則禁止、明確な理由がありユーザーの許可がある場合のみ例外とする

---

## プロジェクト概要

本プロジェクトは **TradeAssist MVP** を構築します。
目的は以下の機能を最小構成で実現することです。

* 実トレード履歴からの **自動トレードノート生成**（構造化 + AI 要約）
* リアルタイム市場データとの **一致判定（ルールベース）**
* 通知および **発注支援 UI**（自動売買は禁止）
* MVP 検証を最優先とした安全設計

エージェントは「勝率を上げる自動売買」を目的にしてはいけません。
本プロジェクトは **判断の質を高める支援ツール** です。

---

## 技術スタック

* **Backend**:  Node.js + OPENAPI
* **Frontend**: TypeScript + Next.js
* **Database**: PostgreSQL（TimescaleDB optional）
* **AI**: OpenAI API（軽量モデル優先）
* **Market Data**: サードパーティ API（例: Twelve Data）
* **Notification**: Firebase / OneSignal

---

## 環境変数ルール

`.env` ファイルに定義し、**絶対にコミットしない**。

```
DB_URL=...
AI_API_KEY=...
MARKET_DATA_API_KEY=...
NOTIFICATION_CONFIG=...
```

❌ 禁止

* API キーやトークンをコードに直接書く
* サンプルとしてでも実値を含める

---

## ディレクトリ構造（遵守）

```
/src
  /backend
    /api        # エンドポイント定義
    /services   # ビジネスロジック
    /models     # DB / スキーマ
    /tests
  /frontend
    /components
    /pages
    /styles
    /tests
/docs
AGENTS.md
README.md
```

---

## コーディング規約

### 共通

* 関数・変数名は意味が分かる名称を使用
* 1ファイル1責務を意識
* DRY 原則を遵守


### コメントルール（重要）

* **なぜこの処理が必要か** を必ず日本語で説明
* 処理の前提条件・制約・副作用をコメントで明示

✅ 良い例

```ts
// RSI が一定以下の場合のみエントリー候補とする
if (rsi < RSI_THRESHOLD) {
  ...
}
```

❌ 悪い例

```ts
if (rsi < 30) {
  ...
}
```

---

## テストポリシー

* ロジック追加時は必ずテスト追加
* 一致判定ロジックは **正常系 / 境界値 / 異常系** を含める
* テストコメントも日本語

```
npm test
```

テスト未実装の PR は **未完了扱い** とします。

---
## ドキュメント更新ルール
* 仕様変更・新機能追加時は必ず関連ドキュメントを更新

## AI エージェントの行動制約

### Allowed

* ファイル読み取り
* テスト実行
* コード生成（日本語コメント必須）

### Ask First（人間確認必須）

* 新規ライブラリ追加
* git push / release
* 本番デプロイ

---

